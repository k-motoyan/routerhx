!function(a){"use strict";function b(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=n++);var c;return null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__],null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c),c}var c=function(a,b){b=b.split("u").join(""),this.r=new RegExp(a,b)};c.__name__=!0,c.prototype={match:function(a){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(a),this.r.s=a,null!=this.r.m},matched:function(a){if(null!=this.r.m&&a>=0&&a<this.r.m.length)return this.r.m[a];throw"EReg::matched"},replace:function(a,b){return a.replace(this.r,b)},__class__:c};var d=function(){};d.__name__=!0,Math.__name__=!0;var e=function(){};e.__name__=!0,e.field=function(a,b){try{return a[b]}catch(c){return null}},e.getProperty=function(a,b){var c;return null==a?null:a.__properties__&&(c=a.__properties__["get_"+b])?a[c]():a[b]},e.callMethod=function(a,b,c){return b.apply(a,c)};var f=function(){};f.__name__=!0,f.string=function(a){return k.Boot.__string_rec(a,"")};var g=function(){};g.__name__=!0,g.replace=function(a,b,c){return a.split(b).join(c)};var h={__ename__:!0,__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"]};h.TNull=["TNull",0],h.TNull.__enum__=h,h.TInt=["TInt",1],h.TInt.__enum__=h,h.TFloat=["TFloat",2],h.TFloat.__enum__=h,h.TBool=["TBool",3],h.TBool.__enum__=h,h.TObject=["TObject",4],h.TObject.__enum__=h,h.TFunction=["TFunction",5],h.TFunction.__enum__=h,h.TClass=function(a){var b=["TClass",6,a];return b.__enum__=h,b},h.TEnum=function(a){var b=["TEnum",7,a];return b.__enum__=h,b},h.TUnknown=["TUnknown",8],h.TUnknown.__enum__=h;var i=function(){};i.__name__=!0,i.createInstance=function(a,b){var c=b.length;switch(c){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6]);case 8:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7]);default:throw"Too many arguments"}return null},i["typeof"]=function(a){var b=typeof a;switch(b){case"boolean":return h.TBool;case"string":return h.TClass(String);case"number":return Math.ceil(a)==a%2147483648?h.TInt:h.TFloat;case"object":if(null==a)return h.TNull;var c=a.__enum__;if(null!=c)return h.TEnum(c);var d;return d=a instanceof Array&&null==a.__enum__?Array:a.__class__,null!=d?h.TClass(d):h.TObject;case"function":return a.__name__||a.__ename__?h.TObject:h.TFunction;case"undefined":return h.TNull;default:return h.TUnknown}};var j={};j.ds={},j.ds.StringMap=function(){this.h={}},j.ds.StringMap.__name__=!0,j.ds.StringMap.__interfaces__=[d],j.ds.StringMap.prototype={set:function(a,b){this.h["$"+a]=b},get:function(a){return this.h["$"+a]},exists:function(a){return this.h.hasOwnProperty("$"+a)},__class__:j.ds.StringMap};var k={};k.Boot=function(){},k.Boot.__name__=!0,k.Boot.getClass=function(a){return a instanceof Array&&null==a.__enum__?Array:a.__class__},k.Boot.__string_rec=function(a,b){if(null==a)return"null";if(b.length>=5)return"<...>";var c=typeof a;switch("function"==c&&(a.__name__||a.__ename__)&&(c="object"),c){case"object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];var d=a[0]+"(";b+="	";for(var e=2,f=a.length;f>e;){var g=e++;d+=2!=g?","+k.Boot.__string_rec(a[g],b):k.Boot.__string_rec(a[g],b)}return d+")"}var h=a.length,i="[";b+="	";for(var j=0;h>j;){var l=j++;i+=(l>0?",":"")+k.Boot.__string_rec(a[l],b)}return i+="]"}var m;try{m=a.toString}catch(n){return"???"}if(null!=m&&m!=Object.toString){var o=a.toString();if("[object Object]"!=o)return o}var p=null,q="{\n";b+="	";var r=null!=a.hasOwnProperty;for(var p in a)(!r||a.hasOwnProperty(p))&&"prototype"!=p&&"__class__"!=p&&"__super__"!=p&&"__interfaces__"!=p&&"__properties__"!=p&&(2!=q.length&&(q+=", \n"),q+=b+p+" : "+k.Boot.__string_rec(a[p],b));return b=b.substring(1),q+="\n"+b+"}";case"function":return"<function>";case"string":return a;default:return String(a)}},k.Boot.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;e>d;){var f=d++,g=c[f];if(g==b||k.Boot.__interfLoop(g,b))return!0}return k.Boot.__interfLoop(a.__super__,b)},k.Boot.__instanceof=function(a,b){if(null==b)return!1;switch(b){case o:return(0|a)===a;case q:return"number"==typeof a;case r:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case p:return!0;default:if(null==a)return!1;if("function"==typeof b){if(a instanceof b)return!0;if(k.Boot.__interfLoop(k.Boot.getClass(a),b))return!0}return b==s&&null!=a.__name__?!0:b==t&&null!=a.__ename__?!0:a.__enum__==b}},k.Boot.__cast=function(a,b){if(k.Boot.__instanceof(a,b))return a;throw"Cannot cast "+f.string(a)+" to "+f.string(b)};var l={};l.Router=a.RouterHx=function(a){if(this.window=window,this.routes=[],this.route_objects=new j.ds.StringMap,this.options=i["typeof"](a)!=h.TNull?a:{class_path_prefix:"",notfound_path:"/404"},!(i["typeof"](this.window.history)!=h.TNull&&i["typeof"]((m=this.window.history,b(m,m.pushState)))!=h.TNull?!0:!1))throw"unusable push state this browser.";l.RouterEvent.init(),this._setPopState()},l.Router.__name__=!0,l.Router.main=function(){},l.Router.prototype={add:function(a,b,d){a=g.replace(a,"/","\\/"),this.routes.push({url_pattern:new c("^"+l.Router.ROUTE_REGEX.replace(a,"([^\\/]+)")+"$",""),class_path:b,method_name:d})},addCb:function(a,b){a=g.replace(a,"/","\\/"),this.routes.push({url_pattern:new c("^"+l.Router.ROUTE_REGEX.replace(a,"([^\\/]+)")+"$",""),cb:b})},setBefore:function(a){this.before=a},setAfter:function(a){this.after=a},run:function(a,b,c){i["typeof"](a)==h.TNull&&(a=window.location.pathname);for(var d=0,e=this.routes;d<e.length;){var f=e[d];if(++d,1==f.url_pattern.match(a)){if(i["typeof"](this.before)!=h.TNull&&(this.before(),this.window.dispatchEvent(l.RouterEvent.eventGlobalBeforeEnd)),i["typeof"](f.cb)!=h.TNull)f.cb.apply(this,this._includeParams(f.url_pattern)),this.window.dispatchEvent(l.RouterEvent.eventMainEnd);else if(i["typeof"](f.class_path)!=h.TNull)for(var g=0,j=["before",f.method_name,"after"];g<j.length;){var k=j[g];++g,this._execObj(f.url_pattern,f.class_path,k)}return i["typeof"](this.after)!=h.TNull&&(this.after(),this.window.dispatchEvent(l.RouterEvent.eventGlobalAfterEnd)),void(b||(i["typeof"](c)==h.TNull?this.window.history.pushState("","",a):this.window.history.pushState("","",c)))}}this.run(this.options.notfound_path,!1,a)},raisePushState:function(a,b,c,d){var e,f=this;e=i["typeof"](d)==h.TNull?window.document.querySelectorAll(a):d.querySelectorAll(a);for(var g=0;g<e.length;){var j=e[g];++g;var l=[k.Boot.__cast(j,Element)];l[0].addEventListener(b,function(a){return function(b){f.run(a[0].getAttribute(c)),b.preventDefault()}}(l))}},_getDefaultOptions:function(){return{class_path_prefix:"",notfound_path:"/404"}},_setPopState:function(){var a=this;this.window.addEventListener("popstate",function(b){i["typeof"](b.state)!=h.TNull&&a.run(window.location.pathname,!0)})},_setPushState:function(a){this.window.history.pushState("","",a)},_includeParams:function(a){var b=[],c=a.r.m.length;if(c=i["typeof"](c)==h.TNull?0:k.Boot.__cast(c,o),c>0)for(var d=1;c>d;){var e=d++;b.push(a.matched(e))}return b},_checkUsablePushState:function(){return i["typeof"](this.window.history)!=h.TNull&&i["typeof"]((m=this.window.history,b(m,m.pushState)))!=h.TNull?!0:!1},_execCb:function(a,b){b.apply(this,this._includeParams(a)),this.window.dispatchEvent(l.RouterEvent.eventMainEnd)},_execObj:function(a,b,c){var d=this.options.class_path_prefix+b;if(!this.route_objects.exists(d)){var f=this._getDynamicClassForJs(b),g=i.createInstance(f,[]);this.route_objects.set(d,g)}var j=this.route_objects.get(d);if(i["typeof"](e.getProperty(j,c))==h.TFunction)switch(e.callMethod(j,e.field(j,c),this._includeParams(a)),c){case"before":this.window.dispatchEvent(l.RouterEvent.eventBeforeEnd);break;case"after":this.window.dispatchEvent(l.RouterEvent.eventAfterEnd);break;default:this.window.dispatchEvent(l.RouterEvent.eventMainEnd)}},_getDynamicClassForJs:function(a){for(var b=window,c=0,d=a.split(".");c<d.length;){var e=d[c];if(++c,i["typeof"](b[e])==h.TNull)throw"class "+e+" not found.";b=b[e]}return b},__class__:l.Router},l.RouterEvent=function(){},l.RouterEvent.__name__=!0,l.RouterEvent.init=function(){l.RouterEvent.eventGlobalBeforeEnd=window.document.createEvent("CustomEvent"),l.RouterEvent.eventGlobalBeforeEnd.initEvent("globalBeforeEnd",!1,!0),l.RouterEvent.eventGlobalAfterEnd=window.document.createEvent("CustomEvent"),l.RouterEvent.eventGlobalAfterEnd.initEvent("globalAfterEnd",!1,!0),l.RouterEvent.eventBeforeEnd=window.document.createEvent("CustomEvent"),l.RouterEvent.eventBeforeEnd.initEvent("beforeEnd",!1,!0),l.RouterEvent.eventAfterEnd=window.document.createEvent("CustomEvent"),l.RouterEvent.eventAfterEnd.initEvent("afterEnd",!1,!0),l.RouterEvent.eventMainEnd=window.document.createEvent("CustomEvent"),l.RouterEvent.eventMainEnd.initEvent("mainEnd",!1,!0)},l.RouterEvent.createGlobalBeforeEnd=function(){l.RouterEvent.eventGlobalBeforeEnd=window.document.createEvent("CustomEvent"),l.RouterEvent.eventGlobalBeforeEnd.initEvent("globalBeforeEnd",!1,!0)},l.RouterEvent.createGlobalAfterEnd=function(){l.RouterEvent.eventGlobalAfterEnd=window.document.createEvent("CustomEvent"),l.RouterEvent.eventGlobalAfterEnd.initEvent("globalAfterEnd",!1,!0)},l.RouterEvent.createBeforeEnd=function(){l.RouterEvent.eventBeforeEnd=window.document.createEvent("CustomEvent"),l.RouterEvent.eventBeforeEnd.initEvent("beforeEnd",!1,!0)},l.RouterEvent.createAfterEnd=function(){l.RouterEvent.eventAfterEnd=window.document.createEvent("CustomEvent"),l.RouterEvent.eventAfterEnd.initEvent("afterEnd",!1,!0)},l.RouterEvent.createMainEnd=function(){l.RouterEvent.eventMainEnd=window.document.createEvent("CustomEvent"),l.RouterEvent.eventMainEnd.initEvent("mainEnd",!1,!0)};var m,n=0;Math.NaN=Number.NaN,Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,Math.isFinite=function(a){return isFinite(a)},Math.isNaN=function(a){return isNaN(a)},String.prototype.__class__=String,String.__name__=!0,Array.__name__=!0;var o={__name__:["Int"]},p={__name__:["Dynamic"]},q=Number;q.__name__=["Float"];var r=Boolean;r.__ename__=["Bool"];var s={__name__:["Class"]},t={};l.Router.BEFORE_METHOD_NAME="before",l.Router.AFTER_METHOD_NAME="after",l.Router.ROUTE_REGEX=new c("<[^/]+>","g"),l.Router.main()}("undefined"!=typeof window?window:exports);